# 安装和运行指南

## 依赖安装

在运行程序之前，请先安装必要的依赖：

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install requests paho-mqtt psutil urllib3
```

## 运行程序

```bash
# 直接运行
python main.py

# 或使用管理脚本
chmod +x manage.sh
./manage.sh start
```

## 针对低配置主机的优化说明

本次优化主要解决了以下问题：

1. **网络请求超时** - 添加了连接和读取超时设置（10秒连接，30秒读取）
2. **连接复用** - 使用session对象复用HTTP连接，减少连接开销
3. **内存合理释放** - 在函数结束时显式删除大对象引用，帮助垃圾回收
4. **内存监控统计** - 每60秒记录进程和系统内存使用情况
5. **MQTT优化** - 减少重连次数和心跳频率，避免资源竞争
6. **资源清理** - 确保程序退出时正确清理所有资源

## 内存监控说明

程序会每60秒输出内存统计信息，格式如下：
```
📊 内存统计 - 进程: RSS=45.2MB, VMS=123.4MB | 系统: 可用=1024MB, 使用率=65.3%
```

- **RSS**: 进程实际使用的物理内存
- **VMS**: 进程使用的虚拟内存
- **系统可用**: 系统剩余可用内存
- **系统使用率**: 系统总内存使用百分比

这些优化可以显著减少在低配置主机上的资源消耗和卡死问题。
